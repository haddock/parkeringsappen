<!DOCTYPE html>
<html>
    <head>
        <title>Parkeringsappen</title>
        <link href="iphone.css" media="screen" rel="stylesheet" type="text/css" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="format-detection" content="telephone=no" />
        <script type="text/javascript" charset="utf-8" src="zepto.min.js"></script>
        <script type="text/javascript" charset="utf-8" src="cordova-1.5.0.js"></script>
        <script type="text/javascript">
            
            
            // If you want to prevent dragging, uncomment this section
            /*
             function preventBehavior(e) 
             { 
             e.preventDefault(); 
             };
             document.addEventListener("touchmove", preventBehavior, false);
             */
            
            /* If you are supporting your own protocol, the var invokeString will contain any arguments to the app launch.
             see http://iphonedevelopertips.com/cocoa/launching-your-own-application-via-a-custom-url-scheme.html
             for more details -jm */
            /*
             function handleOpenURL(url)

             {
             // TODO: do something with the url passed in.
             }
             */
            
            function onBodyLoad()
            {       
                document.addEventListener("deviceready", onDeviceReady, false);
            }
            
            /* When this function is called, Cordova has been initialized and is ready to roll */
            /* If you are supporting your own protocol, the var invokeString will contain any arguments to the app launch.
             see http://iphonedevelopertips.com/cocoa/launching-your-own-application-via-a-custom-url-scheme.html
             for more details -jm */
            function onDeviceReady()
            {
                navigator.geolocation.getCurrentPosition(onSuccess, onError);
                $('div h1').html("world")
            }
            
            function onSuccess(position) 
            {
                alert(position.coords.latitude + ' '  + position.coords.longitude);
                var reverseGeocodeUrl = 'http://maps.googleapis.com/maps/api/geocode/json?latlng=' + position.coords.latitude + ',' + position.coords.longitude + '&sensor=true';
                $.getJSON(reverseGeocodeUrl, onReverseGeocodeResponse);
            }
            
            function onError(error)
            {
                alert('code: ' + error.code + '\n' +
                      'message: ' + error.message + '\n');
            }
            
            function onReverseGeocodeResponse(jsonResult)
            {
                var street = jsonResult.results[0].address_components[1].long_name;
                var addressElement = document.getElementById('address');
                addressElement.innerHTML = street;
                showServiceInfo(street);
            }
            
            function getServiceInfo(street)
            {
                /*
                var url = 'http://stark-night-7978.herokuapp.com/street/' + street;
                alert(url);
                 */
                var serviceElement = document.getElementById('serviceinfo');
                serviceElement.innerHTML = 'hej';
            }
            
        </script>
        <script>
            
            $(document).ready(function(){
                              var activate = ('createTouch' in document) ? 'touchstart' : 'click';
                              
                              $("body > section").first().addClass("current")
                              
                              $("a.back").live(activate, function(event) {
                                               var current = $(this).attr("href");
                                               $(".current").removeClass("current").addClass("reverse");
                                               $(current).addClass("current");
                                               });
                              
                              $(".menu a[href]").live(activate, function(event) {
                                                      var link = $(this), section = link.closest('section'),
                                                      prev_element = "#"+(section.removeClass("current").addClass("reverse").attr("id"));
                                                      $(link.attr("href")).addClass("current");
                                                      $(".current .back").remove();
                                                      $(".current .toolbar").prepend("<a href=\""+prev_element+"\" class=\"back\">Back</a>");
                                                      });
                              });
            
            </script>
    </head>
    <body onload="onBodyLoad()">
        <section id="top">
            <div class="toolbar">
                <h1></h1>
            </div>
            <p id="address">getting address...</p>
            <p id="serviceinfo">getting service info...</p>
        </section>
        <!--
        <section id="menu">
            <div class="toolbar">
                <h1>foo</h1>
            </div>
            <ul class="menu">
                <li class="arrow"><a href="#menu_1">Menu 1</a></li>
                <li class="arrow"><a href="#menu_2">Menu 2</a></li>
                <li class="arrow"><a href="#menu_3">Menu 3</a></li>
            </ul>
        </section>
        <section id="menu_1">
            <div class="toolbar">
                <h1>Menu 1</h1>
            </div>
            <ul class="menu">
                <li>SubMenu 1</li>
                <li>SubMenu 2</li>
            </ul>
        </section>
        <section id="menu_2">
            <div class="toolbar">
                <h1>Menu 2</h1>
            </div>
            <ul class="menu">
                <li>SubMenu 1</li>
                <li>SubMenu 2</li>
            </ul>
        </section>
        <section id="menu_3">
            <div class="toolbar">
                <h1>Menu 3</h1>
            </div>
            <ul class="menu">
                <li>SubMenu 1</li>
                <li>SubMenu 2</li>
            </ul>
        </section>
        -->
    </body>
</html>
